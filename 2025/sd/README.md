code taken from here: [https://github.com/cloneofsimo/minDiffusion/blob/master/superminddpm.py](https://github.com/cloneofsimo/minDiffusion/blob/master/superminddpm.py)

inspiration from here: [https://habr.com/ru/articles/860400/](https://habr.com/ru/articles/860400/)